<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
  <title>CerclEnclume — Thumbnail Generator</title>
  <link rel="manifest" href="./manifest.webmanifest">
  <link rel="stylesheet" href="./assets/brand-tokens.css">
  <style>
    html, body { margin:0; padding:0; background:var(--ce-bg); color:var(--ce-ink); font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; }
    .wrap { max-width: 720px; margin: 0 auto; padding: 16px; }
    header { display:flex; align-items:center; gap:12px; margin: 12px 0 8px; }
    header img { width: 32px; height: 32px; border-radius: 8px; }
    h1 { font-size: 1.25rem; margin: 0; }
    .card { background: var(--ce-surface); border: 1px solid var(--ce-border); border-radius: 16px; padding: 16px; box-shadow: 0 2px 8px rgba(0,0,0,0.04); }
    .row { display:flex; gap: 12px; align-items: center; flex-wrap: wrap; }
    .btn { background: var(--ce-black); color: var(--ce-white); border: none; padding: 12px 16px; border-radius: 12px; cursor: pointer; }
    .btn.alt { background: var(--ce-purple); }
    .btn.ghost { background: transparent; color: var(--ce-black); border:1px solid var(--ce-border); }
    .btn:disabled { opacity: .6; cursor: not-allowed; }
    .muted { color: var(--ce-muted); font-size: .9rem; }
    .progress { height: 8px; background: var(--ce-border); border-radius: 999px; overflow: hidden; }
    .bar { height: 100%; width: 0%; background: var(--ce-purple); }
    details { margin-top: 8px; }
    label { display:flex; align-items:center; gap:8px; }
    input[type="number"] { width: 100px; padding: 8px; border:1px solid var(--ce-border); border-radius:10px; }
    input[type="file"] { display:none; }
    .pill { border:1px solid var(--ce-border); padding:8px 12px; border-radius:999px; cursor:pointer; }
    .pill.active { background: var(--ce-black); color: var(--ce-white); border-color: var(--ce-black); }

    /* Drag–drop */
    .drop { margin-top: 12px; padding: 20px; border: 2px dashed var(--ce-border); border-radius: 16px; text-align: center; background: var(--ce-surface); }
    .drop.highlight { border-color: var(--ce-purple); box-shadow: 0 0 0 4px rgba(139,92,246,0.08); }

    /* Toasts */
    #toasts { position: fixed; z-index: 9999; left: 50%; transform: translateX(-50%); top: 12px; display: flex; flex-direction: column; gap: 8px; }
    .toast { background: var(--ce-surface); border:1px solid var(--ce-border); box-shadow: 0 6px 24px rgba(0,0,0,0.08); padding: 10px 12px; border-radius: 12px; font-size: .95rem; }
  </style>
</head>
<body>
  <div id="toasts" aria-live="polite"></div>

  <div class="wrap">
    <header>
      <img src="./assets/logo.png" alt="Logo" onerror="this.style.display='none'"/>
      <h1>Batch Photo Thumbnail Generator</h1>
    </header>

    <div class="card">
      <div class="row">
        <label class="btn">
          <input id="fileInput" type="file" accept="image/*" multiple>
          Pick images
        </label>
        <label class="btn">
          <input id="folderInput" type="file" webkitdirectory>
          Pick folder
        </label>
        <div id="count" class="muted">No files selected</div>
      </div>

      <div class="drop" id="drop">
        Drag & drop images or a folder here (Chrome/Edge)
      </div>

      <div style="height:12px"></div>

      <div class="row" id="presets">
        <div class="pill" data-size="256">256px</div>
        <div class="pill active" data-size="512">512px</div>
        <div class="pill" data-size="1024">1024px</div>
        <label>Custom <input id="customSize" type="number" min="64" max="4096" step="1" placeholder="px"></label>
      </div>

      <details>
        <summary>Advanced</summary>
        <div class="row" style="margin-top:8px">
          <label><input id="square" type="checkbox"> Make square (center-crop)</label>
          <label>Format
            <select id="format">
              <option value="auto" selected>Auto (PNG if alpha)</option>
              <option value="jpg">JPG</option>
              <option value="png">PNG</option>
            </select>
          </label>
          <label id="qwrap">Quality
            <input id="quality" type="number" min="10" max="100" value="85">
          </label>
          <label><input id="wmToggle" type="checkbox"> Watermark</label>
          <input id="wmText" type="text" placeholder="Watermark text" style="flex:1; min-width:180px">
        </div>
      </details>

      <div style="height:12px"></div>

      <div class="row">
        <button id="go" class="btn" disabled>Generate Thumbnails</button>
        <button id="stop" class="btn" style="background:var(--ce-red)" disabled>Stop</button>
        <button id="saveZip" class="btn alt" disabled>Download ZIP</button>
        <button id="saveFolder" class="btn ghost" disabled>Save to Folder</button>
        <button id="openFolder" class="btn ghost" disabled>Open saved folder</button>
      </div>

      <div style="height:12px"></div>
      <div class="progress"><div id="bar" class="bar"></div></div>
      <div id="status" class="muted" style="margin-top:6px">Ready</div>

      <details id="errorBox" style="margin-top:8px">
        <summary>Errors (<span id="errorCount">0</span>)</summary>
        <ul id="errorList" style="margin:8px 0 0 16px"></ul>
      </details>
    </div>

    <p class="muted" style="margin-top:12px">All processing happens locally in your browser. No uploads.</p>
  </div>

  <script type="module" src="./main.js"></script>
  <script src="./register-sw.js"></script>
</body>
</html>
